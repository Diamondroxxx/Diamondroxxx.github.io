<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="../css/custom.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/vs2015.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
        <title>HSCTF Writeups</title>
    </head>

    <body>
        <nav class="navbar navbar-inverse navbar-fixed-top justify-content-center">
            <div class="container-fluid">
              <div class="navbar-header">
                <a class="navbar-brand" href="#">Diamondroxxx</a>
              </div>
              <ul class="nav navbar-nav">
                <li class="active"><a href="#">Home</a></li>
                <li class="dropdown" id="nav-dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">CTFs
                  <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                    <li><a href="/CTFs/zh3r0.html">zh3r0</a></li>
                    <li><a href="/CTFs/HSCTF.html">HSCTF</a></li>
                  </ul>
                </li>
              </ul>
            </div>
        </nav>

        <div class="container" style="margin-top:50px; background-color: rgba(255, 255, 255, .01); width: 75vw">
          <h1>HSCTF</h1>
          <p>This CTF went great and my team placed 57th overall. I solved a lot of challenges, some alone and some with the help of my team. Overall I had a lot of fun.</p>
          <hr/>

          <h2>Algo: Not Really Math <small>346 solves / 319 points</small></h2>
          <figure class="figure">
            <img src="../img/HSCTF/not-really-math.png" style="height: 70vh; min-height: 300px; display: block; margin-left: auto; margin-right: auto;">
            <figcaption class="figure-caption"><em>The problem statement</em></figcaption>
          </figure>
          <p></p>
          <p>This was an easy solution, requiring me to simply parse the input string and evaluate it.</p>
          <pre id="code-block"><code class="language-python">from pwn import *

def solve(question: str):
    mults = question.split("m") # split by multiplications as they need to be performed after
    for i in range(len(mults)):
        m = mults[i]
        m = "(" + m + ")"
        m = m.replace("a", "+") # place brackets around additions to calculate them first
        mults[i] = m
    q = "*".join(mults)
    ans = eval(q) % (2**32 - 1)
    return ans

r = remote("not-really-math.hsc.tf", 1337)
_ = r.recvline()
for i in range(50): # Unsure of how many so 50 is a large enough buffer
    q = r.recvline(keepends=False)
    print(q) # To check progress and collect flag
    r.sendlineafter(": ", str(solve(str(q)[2:-1])))</code></pre>
          <hr/>

          <h2>Algo: Extended Fibonacci Sequence <small>251 solves / 379 points</small></h2>
          <figure class="figure">
            <img src="../img/HSCTF/ext-fib-1.png" style="height: 70vh; min-height: 300px; display: block; margin-left: auto; margin-right: auto;">
            <figcaption class="figure-caption"><em>The problem statement</em></figcaption>
          </figure>
          <p></p>
          <p>This was also quite easy, as with the use of the <code id="inline-code">lru_cache()</code> decorator the Fibonacci number generation was quick enough.</p>
          <pre id="code-block"><code class="language-python">from functools import lru_cache # Handles memoization for faster fib
from pwn import *

@lru_cache()
def fib(n):
    if n == 0 or n == 1:
        return n
    return fib(n-1) + fib(n-2)

@lru_cache()
def s(n):
    if n == 0:
        return 0
    return int(str(s(n-1)) + str(fib(n)))

def s_sum(n):
    total = 0
    for i in range(1, n+1):
        total += s(i)
    return str(int(str(total)[-11:]))

r = remote("extended-fibonacci-sequence.hsc.tf", 1337)
_ = r.recvline()

for i in range(50):
    line = r.recvline(keepends=False)
    print(line)
    n = int(str(line)[2:-1])
    r.sendlineafter(": ", str(s_sum(n)))</code></pre>
          <hr/>

          <h2>Algo: Extended Fibonacci Sequence 2 <small>186 solves / 417 points</small></h2>
          <figure class="figure">
            <img src="../img/HSCTF/ext-fib-2.png" style="height: 70vh; min-height: 300px; display: block; margin-left: auto; margin-right: auto;">
            <figcaption class="figure-caption"><em>The problem statement</em></figcaption>
          </figure>
          <p></p>
          <p>This problem was virtually identical to Extended Fibonacci Sequence 1 although the catch was that the remote server required much faster inputs. My script for the previous challenge was already fast enough however, so with minor modification for the new specifications it was ready to be used.</p>
          <pre id="code-block"><code class="language-python">from functools import lru_cache
from pwn import *

@lru_cache()
def fib(n):
    if n == 0:
        return 4
    if n == 1:
        return 5
    return fib(n-1) + fib(n-2)

@lru_cache()
def s(n):
    if n == 0:
        return fib(0)
    return s(n-1) + fib(n)

def s_sum(n):
    total = 0
    for i in range(n+1):
        total += s(i)
    return str(int(str(total)[-10:]))

r = remote("extended-fibonacci-sequence-2.hsc.tf", 1337)
print(r.recvline())


for i in range(50):
    print(r.recvline())
    print(r.recvline())
    line = r.recvline(keepends=False)
    print(line)
    n = int(str(line)[2:-1])
    r.sendline(str(s_sum(n)))
    print(r.recvline())</code></pre>
            <hr/>

            <h2>Algo: Hopscotch <small>151 solves / 436 points</small></h2>
            <figure class="figure">
              <img src="../img/HSCTF/hopscotch.png" style="height: 30vh; min-height: 100px; display: block; margin-left: auto; margin-right: auto;">
              <figcaption class="figure-caption"><em>The problem statement</em></figcaption>
            </figure>
            <p></p>
            <p>This problem was quite interesting because while trying out small values I remembered something. Taking F<sub>0</sub> and F<sub>1</sub> as 1, the ways to add up 1 and 2 to get n is F<sub>n</sub>. I learnt this in a part of <a href="https://youtu.be/2MCK3eVwTw4?t=990">this video</a> which covers a functionally identical problem about beats in poetry.</p>
            <pre id="code-block"><code class="language-python">from pwn import *
from functools import lru_cache
import sys

sys.setrecursionlimit(1000) # Facing recursion issues for some reason

@lru_cache()
def fib(n):
    if n == 0 or n == 1:
        return 1
    return fib(n-1) + fib(n-2)

r = remote("hopscotch.hsc.tf", 1337)
print(r.recvline())

for i in range(50):
    line = r.recvline(keepends=False)
    print(line)
    n = int(str(line)[2:-1])
    r.sendlineafter(": ", str(fib(n) % 10000))</code></pre>
            <hr/>

            <h2>Algo: Class Meets <small>116 solves / 454 points</small></h2>
            <figure class="figure">
              <img src="../img/HSCTF/class-meets.png" style="height: 80vh; min-height: 450px; display: block; margin-left: auto; margin-right: auto;">
              <figcaption class="figure-caption"><em>The problem statement</em></figcaption>
            </figure>
            <p></p>
            <p>To solve this challenge I simply made a table with the days each student was going to be in person or virtual and then counted each meet.</p>
            <pre id="code-block"><code class="language-python">from pwn import *

def populate_table(in_person, virtual, end_month, end_day):
    timetable = [0]*(end_month*30 + end_day + 1) # +1 because counting is not zero indexed
    i_counter, v_counter = in_person, virtual
    for i in range(len(timetable)):
        if i % 7 == 5 or i % 7 == 6: # accounts for weekends
            continue
        if i_counter: # checks if any more in-person days are remaining
            timetable[i] = "i"
            i_counter -= 1 # reduce remaining in person days by 1
            continue
        if v_counter > 1: # checks if any more virtual days are remaining
            timetable[i] = "v"
            v_counter -= 1 # reduce remaining virtual days by 1
            continue
        timetable[i] = "v"
        i_counter, v_counter = in_person, virtual # reset counters
    return timetable

def count_meets(stu1, stu2, start_month, start_day):
    meets = 0
    for i in range(start_month*30 + start_day, len(stu1)):
        if stu1[i] !=0 and stu1[i] == stu2[i]: # if not a weekend and both meet
            meets += 1
    return meets

r = remote("class-meets.hsc.tf", 1337)
print(r.recvline())

for i in range(15):
    print(r.recvline())
    print(r.recvline())
    start = str(r.recvline())[2:-3].split(" ")
    end = str(r.recvline())[2:-3].split(" ")
    stu1 = str(r.recvline())[2:-3].split(" ")
    stu2 = str(r.recvline())[2:-3].split(" ")
    print(start, end, stu1, stu2, sep="\n")
    s_month, s_day = [int(i[1:]) for i in start]
    e_month, e_day = [int(i[1:]) for i in end]
    i1, v1 = [int(i[1:]) for i in stu1]
    i2, v2 = [int(i[1:]) for i in stu2]
    student1 = populate_table(i1, v1, e_month, e_day)
    student2 = populate_table(i2, v2, e_month, e_day)
    meets = count_meets(student1, student2, s_month, s_day)
    #print(student1, student2, meets, sep="\n")
    r.sendline(str(meets))
    r.recvline()
print(r.recvall())</code></pre>
            <hr/>

            
          </div>
    </body>
</html>